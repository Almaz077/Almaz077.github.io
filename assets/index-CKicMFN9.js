import{r as x,j as n}from"./index-Be2Hz3rG.js";import{T as M}from"./Table-DixblasI.js";import{k as v,n as N}from"./helpers-DLOf70Zj.js";import{u as w}from"./store-CLPZHClO.js";import{I as E}from"./Input-B6dY_7nE.js";import{C as f}from"./CheckBox-pn17yu53.js";import{s as I}from"./shallow-Bm4ufq9Z.js";const R=({id:a,value:d})=>{const[i,u]=v(r=>[r.nodes,r.updateNodes]),c=x.useMemo(()=>i.find(r=>r.id===a),[i]);if(!c)return n.jsx("div",{children:"узел не найден"});const l=r=>{const p={...c,data:{...c==null?void 0:c.data,name:r}},j=i.map(t=>t.id===p.id?p:t);u(j)};return n.jsx(E,{value:d,onChange:r=>l(r.target.value)})},g={I:0,U:0,HRM3:0},h=["id","name"],A=()=>{const{datas:a,setDatas:d}=w(t=>({datas:t.datas,setDatas:t.setDatas}),I),i=v(t=>t.nodes,I);x.useEffect(()=>{const s=i.filter(e=>{var o,m;return(m=(o=e==null?void 0:e.data)==null?void 0:o.type)==null?void 0:m.toLowerCase().includes("input")}).reduce((e,o)=>(e[o.id]={...a[o.id]??g,id:o.id,name:o.data.name??""},e),{});d(s)},[i]);const u=x.useMemo(()=>Object.values(a),[a]),c=x.useMemo(()=>N({id:"",name:"",...g}),[]),l=()=>c.map(t=>n.jsx("th",{children:t},t)),r=(t,s)=>{const e=a[t];Object.entries(e).some(([m,C])=>m!==s&&!h.includes(m)&&C===1)&&e[s]===0||d({...a,[t]:{...e,[s]:e[s]?0:1}})},p=(t,s,e)=>{t.stopPropagation(),!h.includes(e)&&r(s,e)};return{renderHead:l,renderRow:t=>n.jsx(n.Fragment,{children:c.map(s=>{const e=!h.includes(s);return n.jsx("td",{onClick:e?o=>p(o,t.id,s):void 0,style:{cursor:e?"pointer":"default"},children:s==="name"?n.jsx(R,{value:t.name,id:t.id}):e?n.jsx(f,{checked:!!t[s]}):t[s]},s)})}),rows:u}},D=()=>{const{renderHead:a,renderRow:d,rows:i}=A();return n.jsx("div",{children:n.jsx(M,{renderRow:d,renderHead:a,rowItems:i,getRowKey:u=>u.id,maxWidth:1100})})},S=({})=>n.jsx("div",{children:n.jsx(D,{})});export{S as default};
