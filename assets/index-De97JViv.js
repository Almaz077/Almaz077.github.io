import{r as t,j as n}from"./index-Be2Hz3rG.js";const h=()=>{const[a,g]=t.useState([]),[x,p]=t.useState("connecting"),[i,c]=t.useState(null),r=t.useRef(null),l=t.useRef("connecting"),o=e=>{l.current=e,p(e)},d=()=>{o("connecting"),c(null);const e=new WebSocket("wss://31.13.134.179:3010");e.onopen=()=>{o("connected"),c(null),console.log("WebSocket connected")},e.onmessage=async s=>{if(s.data instanceof Blob){const u=await s.data.text();console.log(u),g(f=>[...f,u])}else console.log(s.data)},e.onerror=()=>{c("Connection error"),o("disconnected")},e.onclose=()=>{console.log("WebSocket closed. Status was:",l.current),l.current!=="disconnected"&&(o("disconnected"),console.log("WebSocket disconnected, reconnecting..."),setTimeout(d,3e3))},r.current=e};return t.useEffect(()=>(d(),()=>{r.current&&(r.current.close(),o("disconnected"))}),[]),n.jsxs("div",{children:[n.jsx("h2",{children:"Web socket"}),n.jsxs("p",{children:["Status: ",x," ",i&&`| Error: ${i}`]}),n.jsx("div",{style:{height:"300px",overflowY:"auto",border:"1px solid blue",padding:"10px",marginTop:"10px"},children:a.length>0?a.map((e,s)=>n.jsx("div",{children:e},s)):n.jsx("p",{children:"Нету принятых сообщений"})})]})};export{h as default};
