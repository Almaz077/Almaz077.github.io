import{r as k,j as c,c as Q,G as Le,R as D,a as Be}from"./index-Be2Hz3rG.js";import{u as M,g as me,B as $e,E as Re,P as A,a as Pe,b as ge,c as Me,d as Ve,H as Fe,e as At,N as We,f as qe,C as Ae,o as ze,i as Xe,l as Ke,h as Ue,j as Ge,t as Ye,F as Ze,k as zt,m as Je,n as Qe,p as Jt,q as tn,R as en,r as nn,s as sn,v as rn}from"./helpers-DLOf70Zj.js";import{M as an}from"./index-BzIBbDJH.js";import{u as ye,a as on}from"./useBleStore-DElSP8Wo.js";import{u as jt,a as ln,b as un}from"./useUpdateSetpointValue-BXREp25a.js";import{B as U}from"./Button-DhdhBf4j.js";import{I as Dt}from"./Input-B6dY_7nE.js";import{v as Tt,c as cn,s as mt}from"./shallow-Bm4ufq9Z.js";import{u as dn}from"./store-D6J7udoj.js";import{u as pn}from"./store-CLPZHClO.js";const fn="_popup_cjxb8_1",hn="_left_cjxb8_61",mn="_center_cjxb8_67",gn="_right_cjxb8_75",yn="_visible_cjxb8_81",vn="_popup__label_cjxb8_91",ut={popup:fn,"popup-content":"_popup-content_cjxb8_11",left:hn,center:mn,right:gn,visible:yn,popup__label:vn},bn=({text:t,children:e,position:r})=>{const[s,n]=k.useState(!1),a=k.useRef(null);k.useEffect(()=>{const i=l=>{a.current&&l.target instanceof Node&&!a.current.contains(l.target)&&n(!1)};return document.addEventListener("click",i),()=>{document.removeEventListener("click",i)}},[]);const o=i=>{i.stopPropagation(),n(l=>!l)};return c.jsxs("div",{className:ut.popup,ref:a,children:[c.jsx(U,{text:t,type:"button",onClick:o}),c.jsxs("div",{className:Q(ut["popup-content"],ut[r],{[ut.visible]:s}),children:[c.jsx("div",{className:ut.popup__label,children:t}),c.jsx("div",{children:e})]})]})};function xn(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 294.1L383 167c9.4-9.4 24.6-9.4 33.9 0s9.3 24.6 0 34L273 345c-9.1 9.1-23.7 9.3-33.1.7L95 201.1c-4.7-4.7-7-10.9-7-17s2.3-12.3 7-17c9.4-9.4 24.6-9.4 33.9 0l127.1 127z"},child:[]}]})(t)}const En="_container_1y4rw_1",_n="_header_1y4rw_19",kn="_title_1y4rw_51",Cn="_arrow_1y4rw_63",wn="_rotated_1y4rw_73",Tn="_content_1y4rw_81",In="_innerContent_1y4rw_91",G={container:En,header:_n,title:kn,arrow:Cn,rotated:wn,content:Tn,innerContent:In},et=({name:t,children:e,defaultOpen:r=!1})=>{const[s,n]=k.useState(r),[a,o]=k.useState(0),i=k.useRef(null);k.useEffect(()=>{i.current&&o(i.current.scrollHeight)},[e]);const l=()=>{n(p=>!p)};return c.jsxs("div",{className:G.container,children:[c.jsxs("button",{className:G.header,onClick:l,"aria-expanded":s,children:[c.jsx("span",{className:G.title,children:t}),c.jsx(xn,{className:Q(G.arrow,{[G.rotated]:s})})]}),c.jsx("div",{ref:i,className:G.content,style:{height:s?`${a}px`:"0px"},"aria-hidden":!s,children:c.jsx("div",{className:G.innerContent,children:e})})]})},Sn={"graph-editor":"_graph-editor_3h800_1"},On=t=>({nodes:t.nodes,edges:t.edges,onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange,addEdge:t.addEdge}),jn={discreteInput:{outputHandles:{out:{dataType:"bool",resultOffset:null}},inputHandles:{},type:"discreteInput"},discreteOutput:{inputHandles:{input:{dataType:"bool"}},outputHandles:{},type:"discreteOutput",name:""},analogInput:{outputHandles:{out:{dataType:"analog",resultOffset:null}},inputHandles:{},type:"analogInput"},analogOutput:{inputHandles:{input:{dataType:"float"}},outputHandles:{},type:"analogOutput",name:""},xor:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"xor"},and:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"and"},or:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"},"input-3":{dataType:"bool"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"or"},nand:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"},"input-3":{dataType:"bool"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"nand"},nor:{inputHandles:{"input-1":{dataType:"bool"},"input-2":{dataType:"bool"},"input-3":{dataType:"bool"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"nor"},notOperation:{inputHandles:{"input-1":{dataType:"bool"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"notOperation"},sumInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"int",resultOffset:null}},type:"sumInt"},multInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"int",resultOffset:null}},type:"multInt"},subInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"int",resultOffset:null}},type:"subInt"},equalsInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"equalsInt"},lessInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"lessInt"},moreInt:{inputHandles:{"input-1":{dataType:"int"},"input-2":{dataType:"int"}},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"moreInt"},timerInt:{inputHandles:{},outputHandles:{out:{dataType:"int",resultOffset:null}},setpointDataType:"int",setpointOffset:null,type:"timerInt",name:"t"},constInt:{inputHandles:{},outputHandles:{out:{dataType:"int",resultOffset:null}},setpointDataType:"int",setpointOffset:null,type:"constInt",name:"c"},constBoolean:{inputHandles:{},outputHandles:{out:{dataType:"bool",resultOffset:null}},setpointDataType:"int",setpointOffset:null,type:"constBoolean",name:"c"},fourierInt:{inputHandles:{"input-1":{dataType:"analog"}},outputHandles:{"out-1":{dataType:"int",resultOffset:null},"out-2":{dataType:"int",resultOffset:null}},type:"fourierInt",setpointDataType:"int",setpointOffset:null},dtrigger:{inputHandles:{},outputHandles:{out:{dataType:"bool",resultOffset:null}},type:"dtrigger"}},ct={discreteInput:{0:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:12,in_type:33}},discreteOutput:{1:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:12,in_type:30}},analogInput:{0:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:12,in_type:33}},analogOutput:{},dtrigger:{},multInt:{2:{instruction:[34,12,156,65,24,66,179,135,231,2,28,193,130,128],lengthInBytes:14,in_type:8}},subInt:{2:{instruction:[34,12,156,65,24,66,153,143,28,193,130,128],lengthInBytes:12,in_type:8}},sumInt:{2:{instruction:[34,12,156,65,24,66,186,151,28,193,130,128],lengthInBytes:12,in_type:8},3:{instruction:[130,128,24,66,156,65,186,151,152,66,186,151,28,193,130,128],lengthInBytes:16,in_type:9},4:{instruction:[130,128,156,65,16,66,148,66,24,67,178,151,182,151,186,151,28,193,130,128],lengthInBytes:20,in_type:10},5:{instruction:[130,128,140,65,16,66,148,66,24,67,156,67,178,149,182,149,186,149,190,149,12,193,130,128],lengthInBytes:24,in_type:11},6:{instruction:[130,128,140,65,16,66,148,66,24,67,156,67,178,149,182,149,186,149,190,149,131,39,8,0,190,149,12,193,130,128],lengthInBytes:30,in_type:12},7:{instruction:[130,128,140,65,16,66,148,66,24,67,156,67,178,149,182,149,186,149,190,149,131,39,8,0,190,149,131,167,8,0,190,149,12,193,130,128],lengthInBytes:36,in_type:13}},notOperation:{1:{instruction:[34,12,131,199,5,0,147,199,23,0,35,0,245,0,130,128],lengthInBytes:16,in_type:1}},and:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,249,143,35,0,245,0,130,128],lengthInBytes:18,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,249,143,3,199,5,0,249,143,35,0,245,0,130,128],lengthInBytes:24,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,35,0,245,0,130,128],lengthInBytes:30,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,125,143,131,199,6,0,125,143,131,71,6,0,125,143,131,199,5,0,125,143,35,0,229,0,130,128],lengthInBytes:36,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,247,7,1,249,143,3,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,35,0,245,0,130,128],lengthInBytes:44,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,120,24,1,51,120,248,0,131,71,7,0,51,120,248,0,131,199,6,0,51,120,248,0,131,71,6,0,51,120,248,0,131,199,5,0,51,120,248,0,35,0,5,1,130,128],lengthInBytes:60,in_type:7}},nand:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:22,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:28,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:34,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,125,143,131,199,6,0,125,143,131,71,6,0,125,143,131,199,5,0,125,143,19,71,23,0,35,0,229,0,130,128],lengthInBytes:40,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,247,7,1,249,143,3,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:48,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,120,24,1,51,120,248,0,131,71,7,0,51,120,248,0,131,199,6,0,51,120,248,0,131,71,6,0,51,120,248,0,131,199,5,0,51,120,248,0,19,72,24,0,35,0,5,1,130,128],lengthInBytes:64,in_type:7}},nor:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:22,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:28,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:34,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,125,143,131,199,6,0,125,143,131,71,6,0,125,143,131,199,5,0,125,143,19,71,23,0,35,0,229,0,130,128],lengthInBytes:40,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,247,7,1,249,143,3,199,6,0,249,143,3,71,6,0,249,143,3,199,5,0,249,143,147,199,23,0,35,0,245,0,130,128],lengthInBytes:48,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,120,24,1,51,120,248,0,131,71,7,0,51,120,248,0,131,199,6,0,51,120,248,0,131,71,6,0,51,120,248,0,131,199,5,0,51,120,248,0,19,72,24,0,35,0,5,1,130,128],lengthInBytes:64,in_type:7}},or:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,217,143,35,0,245,0,130,128],lengthInBytes:18,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,217,143,3,199,5,0,217,143,35,0,245,0,130,128],lengthInBytes:24,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,217,143,3,71,6,0,217,143,3,199,5,0,217,143,35,0,245,0,130,128],lengthInBytes:30,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,93,143,131,199,6,0,93,143,131,71,6,0,93,143,131,199,5,0,93,143,35,0,229,0,130,128],lengthInBytes:36,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,231,7,1,217,143,3,199,6,0,217,143,3,71,6,0,217,143,3,199,5,0,217,143,35,0,245,0,130,128],lengthInBytes:44,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,104,24,1,51,104,248,0,131,71,7,0,51,104,248,0,131,199,6,0,51,104,248,0,131,71,6,0,51,104,248,0,131,199,5,0,51,104,248,0,35,0,5,1,130,128],lengthInBytes:60,in_type:7}},xor:{2:{instruction:[34,12,131,199,5,0,3,71,6,0,185,143,35,0,245,0,130,128],lengthInBytes:18,in_type:2},3:{instruction:[130,128,3,199,6,0,131,71,6,0,185,143,3,199,5,0,185,143,35,0,245,0,130,128],lengthInBytes:24,in_type:3},4:{instruction:[130,128,3,71,7,0,131,199,6,0,185,143,3,71,6,0,185,143,3,199,5,0,185,143,35,0,245,0,130,128],lengthInBytes:30,in_type:4},5:{instruction:[130,128,131,199,7,0,3,71,7,0,61,143,131,199,6,0,61,143,131,71,6,0,61,143,131,199,5,0,61,143,35,0,229,0,130,128],lengthInBytes:36,in_type:5},6:{instruction:[130,128,131,199,7,0,3,72,8,0,3,71,7,0,179,199,7,1,185,143,3,199,6,0,185,143,3,71,6,0,185,143,3,199,5,0,185,143,35,0,245,0,130,128],lengthInBytes:44,in_type:6},7:{instruction:[130,128,3,72,8,0,131,200,8,0,131,199,7,0,51,72,24,1,51,72,248,0,131,71,7,0,51,72,248,0,131,199,6,0,51,72,248,0,131,71,6,0,51,72,248,0,131,199,5,0,51,72,248,0,35,0,5,1,130,128],lengthInBytes:60,in_type:7}},equalsInt:{2:{instruction:[34,12,152,65,28,66,35,0,5,0,99,21,247,0,133,71,35,0,245,0,130,128],lengthInBytes:22,in_type:26}},equalsFloat:{},moreInt:{2:{instruction:[34,12,152,65,28,66,35,0,5,0,99,213,231,0,133,71,35,0,245,0,130,128],lengthInBytes:22,in_type:26}},moreFloat:{},lessInt:{2:{instruction:[34,12,152,65,28,66,35,0,5,0,99,85,247,0,133,71,35,0,245,0,130,128],lengthInBytes:22,in_type:26}},lessFloat:{},constInt:{0:{instruction:[34,12,156,65,28,193,130,128],lengthInBytes:8,in_type:28}},constBoolean:{0:{instruction:[34,12,131,199,5,0,35,0,245,0,130,128],lengthInBytes:8,in_type:29}},timerInt:{0:{instruction:[34,12,28,65,133,7,28,193,152,65,99,84,247,0,35,32,5,0,130,128],lengthInBytes:20,in_type:27}},fourierInt:{1:{instruction:[],lengthInBytes:0,in_type:36},2:{instruction:[],lengthInBytes:0,in_type:37},3:{instruction:[],lengthInBytes:0,in_type:38}}},ot={bool:{clr:"#00ff00",selectedClr:"#08d508"},int:{clr:"#368ff4",selectedClr:"#2b79d2"},float:{clr:"#ffe417",selectedClr:"#ead219"},analog:{clr:"#cd1fe8",selectedClr:"#ab2cbe"}},Nn={bool:void 0,analog:void 0,int:"circle",float:"arrow-closed"},Qt={"button-edge__label":"_button-edge__label_lylsr_1","button-edge__button":"_button-edge__button_lylsr_11"},Dn=({id:t,source:e,sourceHandleId:r,sourceX:s,sourceY:n,targetX:a,targetY:o,selected:i,sourcePosition:l=A.Right,targetPosition:p=A.Left})=>{var T,C,_,w;const{getNode:f,getEdge:E,setEdges:b}=M(),I=E(t),[x,d,g]=me({sourceX:s,sourceY:n,targetX:a,targetY:o,sourcePosition:l,targetPosition:p,borderRadius:8,offset:17}),m=f(e);if(!m||!I||!r)return null;const u=m.data.outputHandles[r==null?void 0:r.split(" ")[1]].dataType;if(!u)return null;const h=i?(T=ot[u])==null?void 0:T.selectedClr:(C=ot[u])==null?void 0:C.clr,y=Nn[u],v=()=>{b(O=>O.filter(H=>H.id!==I.id))};return c.jsxs(c.Fragment,{children:[c.jsxs("defs",{children:[c.jsx("marker",{id:"circle",viewBox:"0 0 10 10",refX:9,refY:5,markerWidth:8,markerHeight:8,orient:"auto-start-reverse",children:c.jsx("circle",{cx:"6",cy:"5",r:"3",fill:(_=ot.int)==null?void 0:_.clr})}),c.jsx("marker",{id:"arrow-closed",viewBox:"0 0 10 10",refX:10,refY:5,markerWidth:8,markerHeight:8,orient:"auto-start-reverse",children:c.jsx("path",{d:"M 0 0 L 10 5 L 0 10 Z",fill:(w=ot.float)==null?void 0:w.clr})})]}),c.jsx($e,{id:t,path:x,style:{stroke:h,strokeWidth:3},markerEnd:y?`url(#${y})`:void 0}),i&&c.jsx(Re,{children:c.jsx("div",{className:Q(Qt["button-edge__label"],"nodrag","nopan"),style:{transform:`translate(-50%, -140%) translate(${d}px,${g}px)`},children:c.jsx("button",{className:Qt["button-edge__button"],onClick:()=>v(),children:c.jsx(an,{})})})})]})};function ve(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(r=ve(t[e]))&&(s&&(s+=" "),s+=r);else for(e in t)t[e]&&(s&&(s+=" "),s+=e);return s}function tt(){for(var t,e,r=0,s="";r<arguments.length;)(t=arguments[r++])&&(e=ve(t))&&(s&&(s+=" "),s+=e);return s}let Hn={data:""},Ln=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||Hn,Bn=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,$n=/\/\*[^]*?\*\/|  +/g,te=/\n+/g,Z=(t,e)=>{let r="",s="",n="";for(let a in t){let o=t[a];a[0]=="@"?a[1]=="i"?r=a+" "+o+";":s+=a[1]=="f"?Z(o,a):a+"{"+Z(o,a[1]=="k"?"":e)+"}":typeof o=="object"?s+=Z(o,e?e.replace(/([^,])+/g,i=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,i):i?i+" "+l:l)):a):o!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=Z.p?Z.p(a,o):a+":"+o+";")}return r+(e&&n?e+"{"+n+"}":n)+s},W={},be=t=>{if(typeof t=="object"){let e="";for(let r in t)e+=r+be(t[r]);return e}return t},Rn=(t,e,r,s,n)=>{let a=be(t),o=W[a]||(W[a]=(l=>{let p=0,f=11;for(;p<l.length;)f=101*f+l.charCodeAt(p++)>>>0;return"go"+f})(a));if(!W[o]){let l=a!==t?t:(p=>{let f,E,b=[{}];for(;f=Bn.exec(p.replace($n,""));)f[4]?b.shift():f[3]?(E=f[3].replace(te," ").trim(),b.unshift(b[0][E]=b[0][E]||{})):b[0][f[1]]=f[2].replace(te," ").trim();return b[0]})(t);W[o]=Z(n?{["@keyframes "+o]:l}:l,r?"":"."+o)}let i=r&&W.g?W.g:null;return r&&(W.g=W[o]),((l,p,f,E)=>{E?p.data=p.data.replace(E,l):p.data.indexOf(l)===-1&&(p.data=f?l+p.data:p.data+l)})(W[o],e,s,i),o},Pn=(t,e,r)=>t.reduce((s,n,a)=>{let o=e[a];if(o&&o.call){let i=o(r),l=i&&i.props&&i.props.className||/^go/.test(i)&&i;o=l?"."+l:i&&typeof i=="object"?i.props?"":Z(i,""):i===!1?"":i}return s+n+(o??"")},"");function Xt(t){let e=this||{},r=t.call?t(e.p):t;return Rn(r.unshift?r.raw?Pn(r,[].slice.call(arguments,1),e.p):r.reduce((s,n)=>Object.assign(s,n&&n.call?n(e.p):n),{}):r,Ln(e.target),e.g,e.o,e.k)}Xt.bind({g:1});Xt.bind({k:1});function Mn(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function xe(t,e,r){return e&&Mn(t.prototype,e),t}function N(){return N=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},N.apply(this,arguments)}function Ee(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function yt(t,e){if(t==null)return{};var r={},s=Object.keys(t),n,a;for(a=0;a<s.length;a++)n=s[a],!(e.indexOf(n)>=0)&&(r[n]=t[n]);return r}function ee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var ne=function(){return""},_e=D.createContext({enqueueSnackbar:ne,closeSnackbar:ne}),Y={downXs:"@media (max-width:599.95px)",upSm:"@media (min-width:600px)"},se=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Kt=function(e){return""+se(e.vertical)+se(e.horizontal)},xt=function(e){return!!e||e===0},Et="unmounted",nt="exited",st="entering",dt="entered",re="exiting",Ut=function(t){Ee(e,t);function e(s){var n;n=t.call(this,s)||this;var a=s.appear,o;return n.appearStatus=null,s.in?a?(o=nt,n.appearStatus=st):o=dt:s.unmountOnExit||s.mountOnEnter?o=Et:o=nt,n.state={status:o},n.nextCallback=null,n}e.getDerivedStateFromProps=function(n,a){var o=n.in;return o&&a.status===Et?{status:nt}:null};var r=e.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(n){var a=null;if(n!==this.props){var o=this.state.status;this.props.in?o!==st&&o!==dt&&(a=st):(o===st||o===dt)&&(a=re)}this.updateStatus(!1,a)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var n=this.props.timeout,a=n,o=n;return n!=null&&typeof n!="number"&&typeof n!="string"&&(o=n.exit,a=n.enter),{exit:o,enter:a}},r.updateStatus=function(n,a){n===void 0&&(n=!1),a!==null?(this.cancelNextCallback(),a===st?this.performEnter(n):this.performExit()):this.props.unmountOnExit&&this.state.status===nt&&this.setState({status:Et})},r.performEnter=function(n){var a=this,o=this.props.enter,i=n,l=this.getTimeouts();if(!n&&!o){this.safeSetState({status:dt},function(){a.props.onEntered&&a.props.onEntered(a.node,i)});return}this.props.onEnter&&this.props.onEnter(this.node,i),this.safeSetState({status:st},function(){a.props.onEntering&&a.props.onEntering(a.node,i),a.onTransitionEnd(l.enter,function(){a.safeSetState({status:dt},function(){a.props.onEntered&&a.props.onEntered(a.node,i)})})})},r.performExit=function(){var n=this,a=this.props.exit,o=this.getTimeouts();if(!a){this.safeSetState({status:nt},function(){n.props.onExited&&n.props.onExited(n.node)});return}this.props.onExit&&this.props.onExit(this.node),this.safeSetState({status:re},function(){n.props.onExiting&&n.props.onExiting(n.node),n.onTransitionEnd(o.exit,function(){n.safeSetState({status:nt},function(){n.props.onExited&&n.props.onExited(n.node)})})})},r.cancelNextCallback=function(){this.nextCallback!==null&&this.nextCallback.cancel&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(n,a){a=this.setNextCallback(a),this.setState(n,a)},r.setNextCallback=function(n){var a=this,o=!0;return this.nextCallback=function(){o&&(o=!1,a.nextCallback=null,n())},this.nextCallback.cancel=function(){o=!1},this.nextCallback},r.onTransitionEnd=function(n,a){this.setNextCallback(a);var o=n==null&&!this.props.addEndListener;if(!this.node||o){setTimeout(this.nextCallback,0);return}this.props.addEndListener&&this.props.addEndListener(this.node,this.nextCallback),n!=null&&setTimeout(this.nextCallback,n)},r.render=function(){var n=this.state.status;if(n===Et)return null;var a=this.props,o=a.children,i=yt(a,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return o(n,i)},xe(e,[{key:"node",get:function(){var n,a=(n=this.props.nodeRef)===null||n===void 0?void 0:n.current;if(!a)throw new Error("notistack - Custom snackbar is not refForwarding");return a}}]),e}(D.Component);function rt(){}Ut.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:rt,onEntering:rt,onEntered:rt,onExit:rt,onExiting:rt,onExited:rt};function ae(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Ft(t,e){return k.useMemo(function(){return t==null&&e==null?null:function(r){ae(t,r),ae(e,r)}},[t,e])}function St(t){var e=t.timeout,r=t.style,s=r===void 0?{}:r,n=t.mode;return{duration:typeof e=="object"?e[n]||0:e,easing:s.transitionTimingFunction,delay:s.transitionDelay}}var Wt={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},ke=function(e){e.scrollTop=e.scrollTop},oe=function(e){return Math.round(e)+"ms"};function it(t,e){t===void 0&&(t=["all"]);var r=e||{},s=r.duration,n=s===void 0?300:s,a=r.easing,o=a===void 0?Wt.easeInOut:a,i=r.delay,l=i===void 0?0:i,p=Array.isArray(t)?t:[t];return p.map(function(f){var E=typeof n=="string"?n:oe(n),b=typeof l=="string"?l:oe(l);return f+" "+E+" "+o+" "+b}).join(",")}function Vn(t){return t&&t.ownerDocument||document}function Ce(t){var e=Vn(t);return e.defaultView||window}function Fn(t,e){e===void 0&&(e=166);var r;function s(){for(var n=this,a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];var l=function(){t.apply(n,o)};clearTimeout(r),r=setTimeout(l,e)}return s.clear=function(){clearTimeout(r)},s}function Wn(t,e){var r=e.getBoundingClientRect(),s=Ce(e),n;if(e.fakeTransform)n=e.fakeTransform;else{var a=s.getComputedStyle(e);n=a.getPropertyValue("-webkit-transform")||a.getPropertyValue("transform")}var o=0,i=0;if(n&&n!=="none"&&typeof n=="string"){var l=n.split("(")[1].split(")")[0].split(",");o=parseInt(l[4],10),i=parseInt(l[5],10)}switch(t){case"left":return"translateX("+(s.innerWidth+o-r.left)+"px)";case"right":return"translateX(-"+(r.left+r.width-o)+"px)";case"up":return"translateY("+(s.innerHeight+i-r.top)+"px)";default:return"translateY(-"+(r.top+r.height-i)+"px)"}}function _t(t,e){if(e){var r=Wn(t,e);r&&(e.style.webkitTransform=r,e.style.transform=r)}}var we=k.forwardRef(function(t,e){var r=t.children,s=t.direction,n=s===void 0?"down":s,a=t.in,o=t.style,i=t.timeout,l=i===void 0?0:i,p=t.onEnter,f=t.onEntered,E=t.onExit,b=t.onExited,I=yt(t,["children","direction","in","style","timeout","onEnter","onEntered","onExit","onExited"]),x=k.useRef(null),d=Ft(r.ref,x),g=Ft(d,e),m=function(C,_){_t(n,C),ke(C),p&&p(C,_)},u=function(C){var _=(o==null?void 0:o.transitionTimingFunction)||Wt.easeOut,w=St({timeout:l,mode:"enter",style:N({},o,{transitionTimingFunction:_})});C.style.webkitTransition=it("-webkit-transform",w),C.style.transition=it("transform",w),C.style.webkitTransform="none",C.style.transform="none"},h=function(C){var _=(o==null?void 0:o.transitionTimingFunction)||Wt.sharp,w=St({timeout:l,mode:"exit",style:N({},o,{transitionTimingFunction:_})});C.style.webkitTransition=it("-webkit-transform",w),C.style.transition=it("transform",w),_t(n,C),E&&E(C)},y=function(C){C.style.webkitTransition="",C.style.transition="",b&&b(C)},v=k.useCallback(function(){x.current&&_t(n,x.current)},[n]);return k.useEffect(function(){if(!(a||n==="down"||n==="right")){var T=Fn(function(){x.current&&_t(n,x.current)}),C=Ce(x.current);return C.addEventListener("resize",T),function(){T.clear(),C.removeEventListener("resize",T)}}},[n,a]),k.useEffect(function(){a||v()},[a,v]),k.createElement(Ut,Object.assign({appear:!0,nodeRef:x,onEnter:m,onEntered:f,onEntering:u,onExit:h,onExited:y,in:a,timeout:l},I),function(T,C){return k.cloneElement(r,N({ref:g,style:N({visibility:T==="exited"&&!a?"hidden":void 0},o,{},r.props.style)},C))})});we.displayName="Slide";var Nt=function(e){return D.createElement("svg",Object.assign({viewBox:"0 0 24 24",focusable:"false",style:{fontSize:20,marginInlineEnd:8,userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0}},e))},qn=function(){return D.createElement(Nt,null,D.createElement("path",{d:`M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41
        10.59L10 14.17L17.59 6.58L19 8L10 17Z`}))},An=function(){return D.createElement(Nt,null,D.createElement("path",{d:"M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"}))},zn=function(){return D.createElement(Nt,null,D.createElement("path",{d:`M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,
        6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,
        13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z`}))},Xn=function(){return D.createElement(Nt,null,D.createElement("path",{d:`M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,
        0 22,12A10,10 0 0,0 12,2Z`}))},Kn={default:void 0,success:D.createElement(qn,null),warning:D.createElement(An,null),error:D.createElement(zn,null),info:D.createElement(Xn,null)},J={maxSnack:3,persist:!1,hideIconVariant:!1,disableWindowBlurListener:!1,variant:"default",autoHideDuration:5e3,iconVariant:Kn,anchorOrigin:{vertical:"bottom",horizontal:"left"},TransitionComponent:we,transitionDuration:{enter:225,exit:195}},Un=function(e,r){var s=function(a){return typeof a=="number"||a===null};return s(e)?e:s(r)?r:J.autoHideDuration},Gn=function(e,r){var s=function(a,o){return o.some(function(i){return typeof a===i})};return s(e,["string","number"])?e:s(e,["object"])?N({},J.transitionDuration,{},s(r,["object"])&&r,{},e):s(r,["string","number"])?r:s(r,["object"])?N({},J.transitionDuration,{},r):J.transitionDuration},Yn=function(e,r){return function(s,n){return n===void 0&&(n=!1),n?N({},J[s],{},r[s],{},e[s]):s==="autoHideDuration"?Un(e.autoHideDuration,r.autoHideDuration):s==="transitionDuration"?Gn(e.transitionDuration,r.transitionDuration):e[s]||r[s]||J[s]}};function vt(t){return Object.entries(t).reduce(function(e,r){var s,n=r[0],a=r[1];return N({},e,(s={},s[n]=Xt(a),s))},{})}var lt={SnackbarContainer:"notistack-SnackbarContainer",Snackbar:"notistack-Snackbar",CollapseWrapper:"notistack-CollapseWrapper",MuiContent:"notistack-MuiContent",MuiContentVariant:function(e){return"notistack-MuiContent-"+e}},ie=vt({root:{height:0},entered:{height:"auto"}}),Ht="0px",Lt=175,Te=k.forwardRef(function(t,e){var r=t.children,s=t.in,n=t.onExited,a=k.useRef(null),o=k.useRef(null),i=Ft(e,o),l=function(){return a.current?a.current.clientHeight:0},p=function(d){d.style.height=Ht},f=function(d){var g=l(),m=St({timeout:Lt,mode:"enter"}),u=m.duration,h=m.easing;d.style.transitionDuration=typeof u=="string"?u:u+"ms",d.style.height=g+"px",d.style.transitionTimingFunction=h||""},E=function(d){d.style.height="auto"},b=function(d){d.style.height=l()+"px"},I=function(d){ke(d);var g=St({timeout:Lt,mode:"exit"}),m=g.duration,u=g.easing;d.style.transitionDuration=typeof m=="string"?m:m+"ms",d.style.height=Ht,d.style.transitionTimingFunction=u||""};return k.createElement(Ut,{in:s,unmountOnExit:!0,onEnter:p,onEntered:E,onEntering:f,onExit:b,onExited:n,onExiting:I,nodeRef:o,timeout:Lt},function(x,d){return k.createElement("div",Object.assign({ref:i,className:tt(ie.root,x==="entered"&&ie.entered),style:N({pointerEvents:"all",overflow:"hidden",minHeight:Ht,transition:it("height")},x==="entered"&&{overflow:"visible"},{},x==="exited"&&!s&&{visibility:"hidden"})},d),k.createElement("div",{ref:a,className:lt.CollapseWrapper,style:{display:"flex",width:"100%"}},r))})});Te.displayName="Collapse";var le={right:"left",left:"right",bottom:"up",top:"down"},Zn=function(e){return e.horizontal!=="center"?le[e.horizontal]:le[e.vertical]},Jn=function(e){return"anchorOrigin"+Kt(e)},Qn=function(e){e===void 0&&(e={});var r={containerRoot:!0,containerAnchorOriginTopCenter:!0,containerAnchorOriginBottomCenter:!0,containerAnchorOriginTopRight:!0,containerAnchorOriginBottomRight:!0,containerAnchorOriginTopLeft:!0,containerAnchorOriginBottomLeft:!0};return Object.keys(e).filter(function(s){return!r[s]}).reduce(function(s,n){var a;return N({},s,(a={},a[n]=e[n],a))},{})},ts=function(){};function gt(t,e){return t.reduce(function(r,s){return s==null?r:function(){for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];var l=[].concat(o);e&&l.indexOf(e)===-1&&l.push(e),r.apply(this,l),s.apply(this,l)}},ts)}var es=typeof window<"u"?k.useLayoutEffect:k.useEffect;function ue(t){var e=k.useRef(t);return es(function(){e.current=t}),k.useCallback(function(){return e.current.apply(void 0,arguments)},[])}var Ie=k.forwardRef(function(t,e){var r=t.children,s=t.className,n=t.autoHideDuration,a=t.disableWindowBlurListener,o=a===void 0?!1:a,i=t.onClose,l=t.id,p=t.open,f=t.SnackbarProps,E=f===void 0?{}:f,b=k.useRef(),I=ue(function(){i&&i.apply(void 0,arguments)}),x=ue(function(h){!i||h==null||(b.current&&clearTimeout(b.current),b.current=setTimeout(function(){I(null,"timeout",l)},h))});k.useEffect(function(){return p&&x(n),function(){b.current&&clearTimeout(b.current)}},[p,n,x]);var d=function(){b.current&&clearTimeout(b.current)},g=k.useCallback(function(){n!=null&&x(n*.5)},[n,x]),m=function(y){E.onMouseEnter&&E.onMouseEnter(y),d()},u=function(y){E.onMouseLeave&&E.onMouseLeave(y),g()};return k.useEffect(function(){if(!o&&p)return window.addEventListener("focus",g),window.addEventListener("blur",d),function(){window.removeEventListener("focus",g),window.removeEventListener("blur",d)}},[o,g,p]),k.createElement("div",Object.assign({ref:e},E,{className:tt(lt.Snackbar,s),onMouseEnter:m,onMouseLeave:u}),r)});Ie.displayName="Snackbar";var Bt,ns=vt({root:(Bt={display:"flex",flexWrap:"wrap",flexGrow:1},Bt[Y.upSm]={flexGrow:"initial",minWidth:"288px"},Bt)}),Se=k.forwardRef(function(t,e){var r=t.className,s=yt(t,["className"]);return D.createElement("div",Object.assign({ref:e,className:tt(ns.root,r)},s))});Se.displayName="SnackbarContent";var pt=vt({root:{backgroundColor:"#313131",fontSize:"0.875rem",lineHeight:1.43,letterSpacing:"0.01071em",color:"#fff",alignItems:"center",padding:"6px 16px",borderRadius:"4px",boxShadow:"0px 3px 5px -1px rgba(0,0,0,0.2),0px 6px 10px 0px rgba(0,0,0,0.14),0px 1px 18px 0px rgba(0,0,0,0.12)"},lessPadding:{paddingLeft:8*2.5+"px"},default:{backgroundColor:"#313131"},success:{backgroundColor:"#43a047"},error:{backgroundColor:"#d32f2f"},warning:{backgroundColor:"#ff9800"},info:{backgroundColor:"#2196f3"},message:{display:"flex",alignItems:"center",padding:"8px 0"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:"16px",marginRight:"-8px"}}),ce="notistack-snackbar",Oe=k.forwardRef(function(t,e){var r=t.id,s=t.message,n=t.action,a=t.iconVariant,o=t.variant,i=t.hideIconVariant,l=t.style,p=t.className,f=a[o],E=n;return typeof E=="function"&&(E=E(r)),D.createElement(Se,{ref:e,role:"alert","aria-describedby":ce,style:l,className:tt(lt.MuiContent,lt.MuiContentVariant(o),pt.root,pt[o],p,!i&&f&&pt.lessPadding)},D.createElement("div",{id:ce,className:pt.message},i?null:f,s),E&&D.createElement("div",{className:pt.action},E))});Oe.displayName="MaterialDesignContent";var ss=k.memo(Oe),rs=vt({wrappedRoot:{width:"100%",position:"relative",transform:"translateX(0)",top:0,right:0,bottom:0,left:0,minWidth:"288px"}}),as=function(e){var r=k.useRef(),s=k.useState(!0),n=s[0],a=s[1],o=gt([e.snack.onClose,e.onClose]),i=function(){e.snack.requestClose&&o(null,"instructed",e.snack.id)},l=k.useCallback(function(){r.current=setTimeout(function(){a(function(w){return!w})},125)},[]);k.useEffect(function(){return function(){r.current&&clearTimeout(r.current)}},[]);var p=e.snack,f=e.classes,E=e.Component,b=E===void 0?ss:E,I=k.useMemo(function(){return Qn(f)},[f]),x=p.open,d=p.SnackbarProps,g=p.TransitionComponent,m=p.TransitionProps,u=p.transitionDuration,h=p.disableWindowBlurListener,y=p.content,v=yt(p,["open","SnackbarProps","TransitionComponent","TransitionProps","transitionDuration","disableWindowBlurListener","content","entered","requestClose","onEnter","onEntered","onExit","onExited"]),T=N({direction:Zn(v.anchorOrigin),timeout:u},m),C=y;typeof C=="function"&&(C=C(v.id,v.message));var _=["onEnter","onEntered","onExit","onExited"].reduce(function(w,O){var H;return N({},w,(H={},H[O]=gt([e.snack[O],e[O]],v.id),H))},{});return D.createElement(Te,{in:n,onExited:_.onExited},D.createElement(Ie,{open:x,id:v.id,disableWindowBlurListener:h,autoHideDuration:v.autoHideDuration,className:tt(rs.wrappedRoot,I.root,I[Jn(v.anchorOrigin)]),SnackbarProps:d,onClose:o},D.createElement(g,Object.assign({},T,{appear:!0,in:x,onExit:_.onExit,onExited:l,onEnter:_.onEnter,onEntered:gt([_.onEntered,i],v.id)}),C||D.createElement(b,Object.assign({},v)))))},ft,$t,kt,Ct,Rt,q={view:{default:20},snackbar:{default:6,dense:2}},de="."+lt.CollapseWrapper,Pt=16,wt=vt({root:(ft={boxSizing:"border-box",display:"flex",maxHeight:"100%",position:"fixed",zIndex:1400,height:"auto",width:"auto",transition:it(["top","right","bottom","left","max-width"],{duration:300,easing:"ease"}),pointerEvents:"none"},ft[de]={padding:q.snackbar.default+"px 0px",transition:"padding 300ms ease 0ms"},ft.maxWidth="calc(100% - "+q.view.default*2+"px)",ft[Y.downXs]={width:"100%",maxWidth:"calc(100% - "+Pt*2+"px)"},ft),rootDense:($t={},$t[de]={padding:q.snackbar.dense+"px 0px"},$t),top:{top:q.view.default-q.snackbar.default+"px",flexDirection:"column"},bottom:{bottom:q.view.default-q.snackbar.default+"px",flexDirection:"column-reverse"},left:(kt={left:q.view.default+"px"},kt[Y.upSm]={alignItems:"flex-start"},kt[Y.downXs]={left:Pt+"px"},kt),right:(Ct={right:q.view.default+"px"},Ct[Y.upSm]={alignItems:"flex-end"},Ct[Y.downXs]={right:Pt+"px"},Ct),center:(Rt={left:"50%",transform:"translateX(-50%)"},Rt[Y.upSm]={alignItems:"center"},Rt)}),os=function(e){var r=e.classes,s=r===void 0?{}:r,n=e.anchorOrigin,a=e.dense,o=e.children,i=tt(lt.SnackbarContainer,wt[n.vertical],wt[n.horizontal],wt.root,s.containerRoot,s["containerAnchorOrigin"+Kt(n)],a&&wt.rootDense);return D.createElement("div",{className:i},o)},is=k.memo(os),pe=function(e){var r=typeof e=="string"||k.isValidElement(e);return!r},P,ls=function(t){Ee(e,t);function e(s){var n;return n=t.call(this,s)||this,n.enqueueSnackbar=function(a,o){if(o===void 0&&(o={}),a==null)throw new Error("enqueueSnackbar called with invalid argument");var i=pe(a)?a:o,l=pe(a)?a.message:a,p=i.key,f=i.preventDuplicate,E=yt(i,["key","preventDuplicate"]),b=xt(p),I=b?p:new Date().getTime()+Math.random(),x=Yn(E,n.props),d=N({id:I},E,{message:l,open:!0,entered:!1,requestClose:!1,persist:x("persist"),action:x("action"),content:x("content"),variant:x("variant"),anchorOrigin:x("anchorOrigin"),disableWindowBlurListener:x("disableWindowBlurListener"),autoHideDuration:x("autoHideDuration"),hideIconVariant:x("hideIconVariant"),TransitionComponent:x("TransitionComponent"),transitionDuration:x("transitionDuration"),TransitionProps:x("TransitionProps",!0),iconVariant:x("iconVariant",!0),style:x("style",!0),SnackbarProps:x("SnackbarProps",!0),className:tt(n.props.className,E.className)});return d.persist&&(d.autoHideDuration=void 0),n.setState(function(g){if(f===void 0&&n.props.preventDuplicate||f){var m=function(v){return b?v.id===I:v.message===l},u=g.queue.findIndex(m)>-1,h=g.snacks.findIndex(m)>-1;if(u||h)return g}return n.handleDisplaySnack(N({},g,{queue:[].concat(g.queue,[d])}))}),I},n.handleDisplaySnack=function(a){var o=a.snacks;return o.length>=n.maxSnack?n.handleDismissOldest(a):n.processQueue(a)},n.processQueue=function(a){var o=a.queue,i=a.snacks;return o.length>0?N({},a,{snacks:[].concat(i,[o[0]]),queue:o.slice(1,o.length)}):a},n.handleDismissOldest=function(a){if(a.snacks.some(function(f){return!f.open||f.requestClose}))return a;var o=!1,i=!1,l=a.snacks.reduce(function(f,E){return f+(E.open&&E.persist?1:0)},0);l===n.maxSnack&&(i=!0);var p=a.snacks.map(function(f){return!o&&(!f.persist||i)?(o=!0,f.entered?(f.onClose&&f.onClose(null,"maxsnack",f.id),n.props.onClose&&n.props.onClose(null,"maxsnack",f.id),N({},f,{open:!1})):N({},f,{requestClose:!0})):N({},f)});return N({},a,{snacks:p})},n.handleEnteredSnack=function(a,o,i){if(!xt(i))throw new Error("handleEnteredSnack Cannot be called with undefined key");n.setState(function(l){var p=l.snacks;return{snacks:p.map(function(f){return f.id===i?N({},f,{entered:!0}):N({},f)})}})},n.handleCloseSnack=function(a,o,i){n.props.onClose&&n.props.onClose(a,o,i);var l=i===void 0;n.setState(function(p){var f=p.snacks,E=p.queue;return{snacks:f.map(function(b){return!l&&b.id!==i?N({},b):b.entered?N({},b,{open:!1}):N({},b,{requestClose:!0})}),queue:E.filter(function(b){return b.id!==i})}})},n.closeSnackbar=function(a){var o=n.state.snacks.find(function(i){return i.id===a});xt(a)&&o&&o.onClose&&o.onClose(null,"instructed",a),n.handleCloseSnack(null,"instructed",a)},n.handleExitedSnack=function(a,o){if(!xt(o))throw new Error("handleExitedSnack Cannot be called with undefined key");n.setState(function(i){var l=n.processQueue(N({},i,{snacks:i.snacks.filter(function(p){return p.id!==o})}));return l.queue.length===0?l:n.handleDismissOldest(l)})},P=n.enqueueSnackbar,n.closeSnackbar,n.state={snacks:[],queue:[],contextValue:{enqueueSnackbar:n.enqueueSnackbar.bind(ee(n)),closeSnackbar:n.closeSnackbar.bind(ee(n))}},n}var r=e.prototype;return r.render=function(){var n=this,a=this.state.contextValue,o=this.props,i=o.domRoot,l=o.children,p=o.dense,f=p===void 0?!1:p,E=o.Components,b=E===void 0?{}:E,I=o.classes,x=this.state.snacks.reduce(function(g,m){var u,h=Kt(m.anchorOrigin),y=g[h]||[];return N({},g,(u={},u[h]=[].concat(y,[m]),u))},{}),d=Object.keys(x).map(function(g){var m=x[g],u=m[0];return D.createElement(is,{key:g,dense:f,anchorOrigin:u.anchorOrigin,classes:I},m.map(function(h){return D.createElement(as,{key:h.id,snack:h,classes:I,Component:b[h.variant],onClose:n.handleCloseSnack,onEnter:n.props.onEnter,onExit:n.props.onExit,onExited:gt([n.handleExitedSnack,n.props.onExited],h.id),onEntered:gt([n.handleEnteredSnack,n.props.onEntered],h.id)})}))});return D.createElement(_e.Provider,{value:a},l,i?Be.createPortal(d,i):d)},xe(e,[{key:"maxSnack",get:function(){return this.props.maxSnack||J.maxSnack}}]),e}(k.Component),us=function(){return k.useContext(_e)};const Gt=(t,e)=>{const{offsetsByTypes:r,setOffsets:s}=ye.getState(),n=[...r[t]];s([...n,e],t)},Ot=t=>{const{offsetsByTypes:e,setOffsets:r}=ye.getState(),s=[...e[t]],n=s.shift();return r(s,t),n},je=(t,e)=>{const{setpointOffsets:r,setSetpointOffsets:s}=jt.getState(),n=[...r[t]];s([...n,e],t)},qt=t=>{const{setpointOffsets:e,setSetpointOffsets:r}=jt.getState(),s=[...e[t]],n=s.shift();return r(s,t),n};function Ne(){const t=k.useRef({x:0,y:0}),e=Pe(u=>u.domNode),{getNodes:r,setNodes:s,getEdges:n,setEdges:a,screenToFlowPosition:o}=M(),[i,l]=k.useState([]),[p,f]=k.useState([]);k.useEffect(()=>{if(!e)return;const u=v=>v.preventDefault(),h=v=>{t.current={x:v.clientX,y:v.clientY}},y=["cut","copy","paste"];return y.forEach(v=>e.addEventListener(v,u)),e.addEventListener("mousemove",h),()=>{y.forEach(v=>e.removeEventListener(v,u)),e.removeEventListener("mousemove",h)}},[e]);const E=k.useCallback(()=>{const u=r().filter(v=>v.selected),y=ge(u,n()).filter(v=>{const T=!u.some(_=>_.id===v.source),C=!u.some(_=>_.id===v.target);return!T&&!C});return{selectedNodes:u,selectedEdges:y}},[r,n]),b=k.useCallback(()=>{const{selectedNodes:u,selectedEdges:h}=E();l(u),f(h)},[E]),I=u=>{const h=u.data;"setpointDataType"in h&&je(h.setpointDataType,h.setpointOffset);for(const y of Object.values(h.outputHandles))Gt(y.dataType,y.resultOffset)},x=k.useCallback(()=>{try{const{selectedNodes:u,selectedEdges:h}=E();u.forEach(I),l(u),f(h),s(y=>y.filter(v=>!v.selected)),a(y=>y.filter(v=>!h.includes(v)))}catch(u){P("Ошибка при вырезании",{variant:"error"}),console.error("Paste error:",u)}},[E,s,a]),d=(u,h,y,v)=>{const T=Tt(),C=h.x+(u.position.x-y),_=h.y+(u.position.y-v),w={};for(const[H,S]of Object.entries(u.data.outputHandles)){const j=Ot(S.dataType);if(j===void 0)throw new Error("Ошибка при выделении памяти");w[H]={dataType:S.dataType,resultOffset:j}}if(!("setpointDataType"in u.data))return{...u,id:T,position:{x:C,y:_},data:{...u.data,outputHandles:w}};const O=qt(u.data.setpointDataType);if(O===void 0)throw new Error("Ошибка при выделении памяти уставки");return{...u,id:T,position:{x:C,y:_},data:{...u.data,outputHandles:w,setpointOffset:O}}},g=u=>{try{const h=Tt(),y=u.positionAbsoluteX+20,v=(u.height??140)+10,T=u.positionAbsoluteY+v;let C;const _={};for(const[O,H]of Object.entries(u.data.outputHandles)){const S=Ot(H.dataType);if(S===void 0)throw new Error("Ошибка при выделении памяти");_[O]={dataType:H.dataType,resultOffset:S}}if(!("setpointDataType"in u.data)){C={...u,id:h,position:{x:y,y:T},data:{...u.data,outputHandles:_}},s(O=>[...O.map(H=>({...H,selected:!1})),C]);return}const w=qt(u.data.setpointDataType);if(w===void 0)throw new Error("Ошибка при выделении памяти уставки");C={...u,id:h,position:{x:y,y:T},data:{...u.data,outputHandles:_,setpointOffset:w}},s(O=>[...O.map(H=>({...H,selected:!1})),C])}catch(h){P("Ошибка при копировании",{variant:"error"}),console.error("Paste error:",h)}},m=k.useCallback(async(u=o(t.current))=>{if(i.length){console.log(i);try{const h=Math.min(...i.map(_=>_.position.x)),y=Math.min(...i.map(_=>_.position.y)),v=await Promise.all(i.map(_=>d(_,u,h,y))),T=Object.fromEntries(i.map((_,w)=>[_.id,v[w].id])),C=p.map(_=>{var w,O;return{..._,id:Tt(),source:T[_.source],sourceHandle:`${T[_.source]} ${(w=_.sourceHandle)==null?void 0:w.split(" ")[1]}`,target:T[_.target],targetHandle:`${T[_.target]} ${(O=_.targetHandle)==null?void 0:O.split(" ")[1]}`}});s(_=>[..._.map(w=>({...w,selected:!1})),...v]),a(_=>[..._.map(w=>({...w,selected:!1})),...C])}catch(h){P("Ошибка при копировании",{variant:"error"}),console.error("Paste error:",h)}}},[i,p,o,s,a]);return Mt(["Meta+x","Control+x"],x),Mt(["Meta+c","Control+c"],b),Mt(["Meta+v","Control+v"],m),{cut:x,copy:b,paste:m,bufferedNodes:i,bufferedEdges:p,createDublicate:g}}function Mt(t,e){const[r,s]=k.useState(!1),n=Me(t);k.useEffect(()=>{n&&!r?(e(),s(!0)):!n&&r&&s(!1)},[n,r,e])}const cs="_row_1sy6z_1",ds="_input_1sy6z_9",ps="_outputs_1sy6z_19",fs="_wraps_1sy6z_29",hs="_text_1sy6z_49",z={row:cs,input:ds,outputs:ps,wraps:fs,"handle-wrap":"_handle-wrap_1sy6z_41",text:hs},ms="_handle_12t9t_1",gs={handle:ms},It=({id:t,type:e,position:r,dataType:s})=>{const a=Ve().filter(o=>e==="target"&&o.targetHandle===`${t}`);return c.jsx(Fe,{type:e,position:r,id:`${t}`,style:{backgroundColor:s&&ot[s].clr,transform:r===A.Left?"translate(-100%, -50%)":r===A.Right?"translate(100%, -50%)":r===A.Top?"translate(-50%, -100%)":"translate(-50%, 100%)"},isConnectable:a.length<1,className:gs.handle})},fe={"handles-column":"_handles-column_gcrpe_1","handle-wrap":"_handle-wrap_gcrpe_11"},ys=({nodeId:t,inputHandles:e})=>c.jsx("div",{className:fe["handles-column"],children:Object.keys(e).map(r=>c.jsx("div",{className:fe["handle-wrap"],children:c.jsx(It,{id:`${t} ${r}`,type:"target",position:A.Left,dataType:e[r].dataType})},r))}),vs={analogInput:["updateName","updateSetpointValue","delete","dublicate"],discreteInput:["updateName","delete","dublicate"],discreteOutput:["updateName","delete","dublicate"],constInt:["updateSetpointValue","updateName","delete","dublicate"],fourierInt:["updateName","changeFourierGarmonics","delete","dublicate"],xor:["delete","dublicate"],and:["invert","delete","dublicate"],or:["invert","delete","dublicate"],nand:["invert","delete","dublicate"],nor:["invert","delete","dublicate"],multInt:["delete","dublicate"],sumInt:["delete","dublicate"],subInt:["delete","dublicate"],timerInt:["updateSetpointValue","updateName","delete","dublicate"],equalsInt:["delete","dublicate"],lessInt:["delete","dublicate"],moreInt:["delete","dublicate"]},bs=t=>"setpointDataType"in t,xs={delete:{key:"deleteNode",label:"delete node",dependencies:["useDeleteNode"],createElement:({node:t,dependencies:e})=>{var o;const{id:r,data:s}=t,n=(o=e.useDeleteNode)==null?void 0:o.call(e);if(!n)return null;const{handleDelete:a}=n;return c.jsx(U,{text:"Удалить",onClick:()=>a(r,s)})}},dublicate:{key:"dublicate",label:"dublicate node",dependencies:["useCopyPaste"],createElement:({node:t,dependencies:e})=>{var n;const r=(n=e.useCopyPaste)==null?void 0:n.call(e);if(!r)return null;const{createDublicate:s}=r;return c.jsx(U,{text:"Дублировать",onClick:()=>s(t)})}},changeFourierGarmonics:{key:"invert",label:"Инвертировать",dependencies:["useUpdateFourierValue"],createElement:({node:t,dependencies:e})=>{const{data:r}=t;if(!("setpointDataType"in r))return;const{setpointOffset:s,outputHandles:n}=r;if(!(e!=null&&e.useUpdateFourierValue))return null;const{handleFourierGarmonicForOutput:a,inputsValue:o}=e==null?void 0:e.useUpdateFourierValue(s),i=Object.values(n).reduce((l,p,f)=>(f%2===0?l.push([p]):l[l.length-1].push(p),l),[]);return c.jsx("div",{onDoubleClick:l=>{l.stopPropagation()},className:"nodrag nopan nowheel",style:{display:"flex",gap:"10px",width:"max-content"},children:i.map((l,p)=>c.jsx(Dt,{style:{width:"60px"},type:"number",value:o[p],onChange:f=>a(p,f.target.value)},p))})}},invert:{key:"invert",label:"Инвертировать",dependencies:["useInverseNode"],createElement:({node:t,dependencies:e})=>{var a;const{id:r,data:s}=t,n=(a=e.useInverseNode)==null?void 0:a.call(e,r,s.type);return c.jsx(U,{onClick:n,text:"Инвертировать",type:"button"})}},updateSetpointValue:{key:"updateSetpointValue",label:"Изменить значение",dependencies:["useUpdateSetpointValue"],createElement:({node:t,dependencies:e})=>{var l;const{data:r}=t;if(!bs(r))return null;const s=r.setpointOffset,n=r.setpointDataType;if(s==null)return null;const a=(l=e.useUpdateSetpointValue)==null?void 0:l.call(e,n,s);if(!a)return null;const{handleChange:o,inputValue:i}=a;return c.jsx("div",{className:"flex flex-col gap-2",children:c.jsx(Dt,{type:"text",value:i,onChange:o,placeholder:"Введите значение"})})}},updateName:{key:"updateName",label:"Изменить значение",dependencies:["useUpdateNameValue"],createElement:({node:t,dependencies:e})=>{var i;const{id:r,data:s}=t,n=(i=e.useUpdateNameValue)==null?void 0:i.call(e,r,s);if(!n)return null;const{name:a,handleChangeName:o}=n;return c.jsx("div",{className:"flex flex-col gap-2",children:c.jsx(Dt,{type:"text",value:a,onChange:o,placeholder:"Введите имя"})})}}},Es=t=>Object.values({0:"1",1:"2",2:"3",3:"4",4:"5",5:"6",6:"7",7:"8"}).slice(0,t).reduce((r,s)=>(r[s]=void 0,r),{}),_s=t=>{const{updateNodeData:e,getEdges:r,setEdges:s,getNode:n}=M(),a=At(),o=[...new Array(10)].reduce((l,p,f)=>(l.push({value:f+1}),l),[]);return{changeHandles:k.useCallback(l=>{e(t,{inputHandlesCount:l}),a(t);const p=r(),f=Object.keys(Es(+l)).map(b=>`${t} ${b}`),E=p.filter(b=>b.target!==t||b.targetHandle&&f.includes(b.targetHandle));s(E)},[t,e,a,r,s,n]),items:o}},ks={or:"nor",and:"nand",nor:"or",nand:"and"},Cs=(t,e)=>{const{updateNodeData:r}=M();return k.useCallback(()=>{r(t,{type:ks[e]})},[t,e,r])},ws=(t,e)=>{const{updateNodeData:r}=M(),s=n=>{const a=n.target.value;r(t,{name:a})};return{name:e.name,handleChangeName:s}},Ts=()=>{const{setNodes:t,setEdges:e}=M();return{handleDelete:(s,n)=>{"setpointOffset"in n&&n.setpointOffset!==void 0&&je(n.setpointDataType,n.setpointOffset);for(const a of Object.values(n.outputHandles))Gt(a.dataType,a.resultOffset);t(a=>a.filter(o=>o.id!==s)),e(a=>a.filter(o=>o.target!==s&&o.source!==s))}}},Is=t=>{var n;const{type:e}=t.data,r={useChangeHandles:_s,useInverseNode:Cs,useUpdateSetpointValue:un,useUpdateNameValue:ws,useDeleteNode:Ts,useUpdateFourierValue:ln,useCopyPaste:Ne};return{actions:(n=vs[e])==null?void 0:n.map(a=>{const o=xs[a];if(!o)return null;const i=o.dependencies.reduce((l,p)=>(p in r&&(l[p]=r[p]),l),{});return{key:o.key,label:o.label,element:o.createElement({node:t,dependencies:i})}})}},he={"context-menu-block":"_context-menu-block_64p36_1","menu-item":"_menu-item_64p36_15"},Ss=k.memo(({actions:t,visible:e,setVisible:r})=>{const s=k.useRef(null);return k.useEffect(()=>{const n=a=>{s.current&&!s.current.contains(a.target)&&r(!1)};return document.addEventListener("click",n),()=>document.removeEventListener("click",n)},[]),c.jsx(We,{isVisible:e,children:c.jsx("div",{ref:s,className:he["context-menu-block"],children:t.map((n,a)=>c.jsx("div",{className:he["menu-item"],children:n.element},a))})})}),L=({node:t,children:e})=>{const[r,s]=k.useState(!1),{actions:n}=Is(t);return c.jsxs("div",{style:{position:"relative"},onDoubleClick:()=>s(a=>!a),children:[e,c.jsx(Ss,{actions:n,visible:r,setVisible:s})]})},Os="_inc_1tbfq_1",js="_dec_1tbfq_9",Ns="_disabled_1tbfq_47",ht={"inc-dec":"_inc-dec_1tbfq_1",inc:Os,dec:js,disabled:Ns},X=({node:t,children:e})=>{const{id:r,data:s}=t,{updateNodeData:n,setEdges:a}=M(),o=At(),i=s.inputHandles||{},l=Object.keys(i),p=i[l[0]].dataType,f={min:2,max:10},E=()=>{const d=l.length;if(d>=f.max)return;const g=`input-${d+1}`,m={...i,[g]:{dataType:p}};n(r,{inputHandles:m}),o(r)},b=()=>{if(l.length<=f.min)return;const m=Object.keys(i).filter(y=>y.startsWith("input-")).sort((y,v)=>{const T=parseInt(y.replace("input-",""),10);return parseInt(v.replace("input-",""),10)-T})[0],{[m]:u,...h}=i;a(y=>y.filter(v=>v.targetHandle!==`${r} ${m}`)),n(r,{inputHandles:h}),o(r)},I=l.length>=f.max,x=l.length<=f.min;return c.jsxs("div",{className:ht["inc-dec"],children:[c.jsx("button",{className:Q(ht.inc,"nodrag",{[ht.disabled]:I}),onClick:E,disabled:I,children:"+"}),e,c.jsx("button",{className:Q(ht.dec,"nodrag",{[ht.disabled]:x}),onClick:b,disabled:x,children:"—"})]})},Ds="_btn_aosl1_9",Hs="_inc_aosl1_1",Ls="_disabled_aosl1_41",Bs="_dec_aosl1_47",K={"inc-dec":"_inc-dec_aosl1_1","btns-row":"_btns-row_aosl1_9",btn:Ds,inc:Hs,disabled:Ls,dec:Bs},$s=({node:t,children:e})=>{const{id:r,data:s}=t,{updateNodeData:n,setEdges:a}=M(),o=s.outputHandles||{},i=Object.keys(o),l={min:2,max:6},p=At(),f=()=>{const x=i.length,d=l.max-x,g=Math.min(2,d);if(g>0){const m={...o};for(let u=1;u<=g;u++){const h=Ot("int");if(!h){P("Не удалсоь выделить смещение типа int",{variant:"error"});return}const y=`out-${x+u}`;m[y]={dataType:"int",resultOffset:h}}n(r,{outputHandles:m}),p(r)}},E=()=>{const d=i.length-l.min,g=Math.min(2,d);if(g>0){const m={...o},u=Object.keys(m).filter(h=>h.startsWith("out-")).sort((h,y)=>{const v=parseInt(h.replace("out-",""),10);return parseInt(y.replace("out-",""),10)-v});for(let h=0;h<g;h++){const y=u[h];a(v=>v.filter(T=>T.sourceHandle!==`${r} ${y}`)),Gt("int",o[y].resultOffset),delete m[y]}n(r,{outputHandles:m}),p(r)}},b=i.length>=l.max,I=i.length<=l.min;return c.jsxs("div",{className:K["inc-dec"],children:[e,c.jsxs("div",{className:K["btns-row"],children:[c.jsx("button",{className:Q(K.btn,K.inc,"nodrag",{[K.disabled]:b}),onClick:f,disabled:b,children:"+"}),c.jsx("button",{className:Q(K.btn,K.dec,"nodrag",{[K.disabled]:I}),onClick:E,disabled:I,children:"—"})]})]})},Rs={analogInput:[L],discreteInput:[L],discreteOutput:[L],fourierInt:[L,$s],constInt:[L],xor:[L,X],and:[L,X],or:[L,X],nand:[L,X],nor:[L,X],multInt:[L,X],sumInt:[L,X],subInt:[L,X],timerInt:[L],equalsInt:[L],lessInt:[L],moreInt:[L]},Ps=(t,e)=>(Rs[t.data.type]||[]).reduce((s,n,a)=>c.jsx(n,{node:t,children:s},`feature-${a}`),e),Ms=k.memo(t=>{console.log(t);const{type:e,inputHandles:r,outputHandles:s}=t.data,n=qe[e];if(!n)return null;const{view:a,...o}=n,i=c.jsxs("div",{className:z.row,children:[!!Object.keys(r).length&&c.jsx(ys,{nodeId:t.id,inputHandles:r}),c.jsx(a,{...o}),!!Object.keys(s).length&&Object.keys(s).map(f=>c.jsx(It,{id:`${t.id} ${f}`,type:"source",position:A.Right,dataType:s[f].dataType},f))]}),p=e!=="fourierInt"?i:(()=>{const f=Object.keys(r).length,E=Object.keys(r)[0];return c.jsxs("div",{className:z.row,children:[!!f&&c.jsx("div",{className:z.input,children:c.jsx(It,{id:`${t.id} ${E}`,type:"target",position:A.Left,dataType:r[E].dataType},E)}),c.jsx(a,{...o}),!!Object.keys(s).length&&c.jsx("div",{className:z.outputs,children:Array.from({length:Math.ceil(Object.keys(s).length/2)},(b,I)=>Object.keys(s).slice(I*2,I*2+2)).map((b,I)=>c.jsx("div",{className:z.wraps,children:b.map((x,d)=>c.jsxs("div",{className:z["handle-wrap"],children:[d===0?c.jsx("div",{className:z.text,children:"Amp"}):c.jsx("div",{className:z.text,children:"Ph"}),c.jsx(It,{id:`${t.id} ${x}`,type:"source",position:A.Right,dataType:s[x].dataType},`${I}-${d}`)]},x))},I))})]})})();return Ps(t,p)}),Vs={account:"paid-pro",hideAttribution:!0};Ae.SmoothStep;const Fs={node:Ms},Ws={"custom-edge":Dn},qs=({fromX:t,fromY:e,toX:r,toY:s,fromPosition:n,fromHandle:a,toPosition:o,fromNode:i})=>{var f,E,b,I;const[l]=me({sourceX:t,sourceY:e,targetX:r,targetY:s,offset:16,sourcePosition:n,targetPosition:o});if(!i||!a||!a.id)return null;const p=((E=i.data.outputHandles[(f=a.id)==null?void 0:f.split(" ")[1]])==null?void 0:E.dataType)||((I=i.data.inputHandles[(b=a.id)==null?void 0:b.split(" ")[1]])==null?void 0:I.dataType);return p?c.jsx("g",{children:c.jsx("path",{fill:"none",stroke:ot[p].clr,strokeWidth:2,d:l})}):null},As="_panel__item_1tehr_15",zs="_name_1tehr_41",Vt={"sidebar-item-drag-image":"_sidebar-item-drag-image_1tehr_1",panel__item:As,name:zs},Xs=({viewData:t,type:e})=>{const r=k.useRef(null),{view:s,name:n,...a}=t,o=i=>{var l;(l=i.dataTransfer)==null||l.setData("application/reactflow",e),r.current&&i.dataTransfer.setDragImage(r.current,0,0)};return c.jsxs("div",{className:Vt.panel__item,draggable:!0,onDragStart:o,children:[c.jsx(s,{...a}),c.jsx("div",{className:Vt.name,children:n}),c.jsx("div",{className:Vt["sidebar-item-drag-image"],ref:r,children:c.jsx(s,{...a})})]})},Ks="_elements_15sbx_1",Us={elements:Ks},at=({views:t})=>c.jsx("div",{className:Us.elements,children:Object.entries(t).map(e=>c.jsx(Xs,{viewData:e[1],type:e[0]},e[0]))}),Gs=()=>c.jsx("div",{children:c.jsxs(bn,{text:"Библиотека",position:"right",children:[c.jsx(et,{name:"Входы и выходы",children:c.jsx(at,{views:{...Xe,...ze}})}),c.jsx(et,{name:"Логические элементы",children:c.jsx(at,{views:Ke})}),c.jsx(et,{name:"Алгебраические операции",children:c.jsx(at,{views:Ue})}),c.jsx(et,{name:"Операции сравнения",children:c.jsx(at,{views:Ge})}),c.jsx(et,{name:"Выдержки времени",children:c.jsx(at,{views:Ye})}),c.jsx(et,{name:"Фурье",children:c.jsx(at,{views:Ze})})]})}),Ys=(t,e,r)=>{if(!e.length)return{newPrimitiveData:{lengthInBytes:t.lengthInBytes,offset:1},newOffset:1,lastLength:t.lengthInBytes};const s=e.slice(-1)[0]+r,n={lengthInBytes:t.lengthInBytes,offset:s};return{newOffset:s,newPrimitiveData:n,lastLength:t.lengthInBytes}},Zs=cn((t,e)=>({offsetsByTypes:{bool:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],int:[16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76],float:[80,84,88,92,96,100,104,108,112,116,120,124,128,132,136,140],analog:[150,230,310,390,470,550,630,710,790,870,950,1030,1110,1190,1270,1350]},setOffsets(r,s){t({offsetsByTypes:{...e().offsetsByTypes,[s]:[...r]}})}}));function Js(t,e=512){const s=new TextEncoder().encode(t),n=[];let a=0;for(;a<s.length;){const o=s.slice(a,a+e),i=new TextDecoder().decode(o);n.push(i),a+=e}return n}const Qs=()=>{const[t,e]=zt(d=>[d.nodes,d.edges],mt),r=on(d=>d.sendConfig),[s,n,a,o]=dn(d=>[d.indications,d.smsText,d.smsWebText,d.phoneNumber],mt),i=pn(d=>d.datas,mt),{setpointsValues:l}=jt(d=>({setpointsValues:d.setpointsValues})),p=()=>({lastLength:0,instructions:[],offsets:[],primitivesData:{}}),f=(d,g,m)=>{var y;const u=d.data.type;if(Qe(ct).includes(u)&&!((y=m.primitivesData[u])!=null&&y[g])){const v=ct[u];if(v&&v[g]){m.instructions.push(...v[g].instruction);const{newOffset:T,newPrimitiveData:C,lastLength:_}=Ys(ct[u][g],m.offsets,m.lastLength);m.primitivesData[u]={...m.primitivesData[u],[g]:C},m.offsets.push(T),m.lastLength=_}}},E=(d,g,m,u,h)=>{var y,v,T,C,_,w;try{const O=d.data.type,H=Object.keys(d.data.inputHandles).length,S=Math.ceil(Object.keys(d.data.outputHandles).length/2);let j;if(O.includes("Output")){const $=d.data.inputHandles.input.dataType;if(!u[$]||u[$].length===0)throw new Error(`Недостаточно смещений для типа вывода ${$}`);j=[u[$].shift()]}else j=Object.entries(d.data.outputHandles).map(([$,R])=>R.resultOffset);const B=Object.keys(d.data.inputHandles).reduce(($,R)=>{var Zt;const F=(Zt=g.find(bt=>`${d.id} ${R}`===bt.targetHandle))==null?void 0:Zt.sourceHandle;if(!F)throw new Error(`Не найдено исходный handle для handle ${R} узла ${d.id}`);const Yt=h.find(bt=>Object.keys(bt.data.outputHandles).find(He=>`${bt.id} ${He}`===F));if(!Yt)throw new Error(`Не найдено исходный узел для handle ${R} узла ${d.id}`);const De=Yt.data.outputHandles[F.split(" ")[1]].resultOffset;return $.push(De),$},[]);"setpointOffset"in d.data&&B.unshift(d.data.setpointOffset);let V;return O==="fourierInt"?(V={inType:(v=(y=ct[O])==null?void 0:y[S])==null?void 0:v.in_type,sourcesOffsets:B,resultOffsets:j},V):(V={inType:(C=(T=ct[O])==null?void 0:T[H])==null?void 0:C.in_type,instructionOffset:(w=(_=m.primitivesData[O])==null?void 0:_[H])==null?void 0:w.offset,resultOffsets:j,sourcesOffsets:B},V)}catch(O){throw new Error(`Ошибка при создании scriptItem для узла ${d.id}: ${O instanceof Error?O.message:String(O)}`)}},b=(d,g)=>{try{const m=Object.keys(g.data.inputHandles);if(m.length===0)return!0;for(const u of m)if(!d.find(y=>y.targetHandle===`${g.id} ${u}`))throw new Error(`Не найдено исходное смещение для handle ${u} узла ${g.id}`)}catch(m){throw new Error(`Ошибка при создании scriptItem для узла ${g.id}: ${m instanceof Error?m.message:String(m)}`)}},I=(d,g,m,u,h)=>{if(g.has(d.id))return{success:!0};g.add(d.id);try{d.data.type!=="fourierInt"&&f(d,Object.keys(d.data.inputHandles).length,u);const y=ge([d],e),{targets:v}=y.reduce((_,w)=>(w.source===d.id&&_.sources.push(w),w.target===d.id&&_.targets.push(w),_),{sources:[],targets:[]});b(v,d);const T=Je(d,t,e),C=E(d,v,u,h,T);for(const _ of T){const w=I(_,g,m,u,h);if(!w.success)return w}return m.push(C),{success:!0}}catch(y){return{success:!1,error:y instanceof Error?y:new Error(String(y))}}};return{saveConfig:async()=>{var d;try{const g=[],m=new Set,u=p(),{offsetsByTypes:h}=Zs.getState(),y=JSON.parse(JSON.stringify(h)),v=t.filter(S=>{var j,B;return(B=(j=S==null?void 0:S.data)==null?void 0:j.type.toLowerCase())==null?void 0:B.includes("output")});if(!v.length){const S=new Error("Нет выходных элементов");return P(S.message,{variant:"error"}),{success:!1,error:S}}for(const S of v){const j=I(S,m,g,u,y);if(!j.success)return P(((d=j.error)==null?void 0:d.message)||"Ошибка при генерации скрипта",{variant:"error"}),j}console.log(g);const T=g.map(S=>{let j=[];for(("instructionOffset"in S)?j=[S.inType,S.instructionOffset,...S.resultOffsets,...S.sourcesOffsets]:j=[S.inType,...S.sourcesOffsets,...S.resultOffsets];j.length<10;)j.push(0);return j}),C=Object.values(s).map(({led1:S,led2:j,led3:B,blOn:V,blOff:$,sms:R,smsWeb:F})=>[S,j,B,V,$,R,F]),_=Object.values(i).map(({I:S,U:j,HRM3:B})=>[S,j,B]),w={scripts:T,functions:u.instructions,setpoints:l,outputMatrix:C,inputMatrix:_,sms:n,smsWeb:a,phoneNumber:o};console.log(w);const O=JSON.stringify(w),H=Js(O,512);return H.push("end"),H.forEach((S,j)=>setTimeout(()=>r(S),j*1e3)),{success:!0}}catch(g){const m=g instanceof Error?g.message:"Неизвестная ошибка при сохранении конфигурации";return P(m,{variant:"error"}),{success:!1,error:g instanceof Error?g:new Error(String(g))}}}}},tr=({nodes:t})=>{const{saveConfig:e}=Qs(),{cut:r,copy:s,paste:n,bufferedNodes:a}=Ne(),o=t.some(({selected:l})=>l),i=a.length>0;return c.jsxs(c.Fragment,{children:[c.jsx(Jt,{position:"top-right",children:c.jsx(Gs,{})}),c.jsxs(Jt,{position:"top-center",style:{display:"flex",gap:"10px"},children:[c.jsx(U,{text:"cut",type:"button",onClick:()=>r(),disabled:!o}),c.jsx(U,{text:"copy",type:"button",onClick:()=>s(),disabled:!o}),c.jsx(U,{text:"paste",type:"button",onClick:()=>n(),disabled:!i}),c.jsx(U,{text:"Отправить",type:"button",onClick:()=>e()})]})]})},er=t=>{const{setpointsValues:e,setSetpoints:r}=jt.getState(),s=[...e];s.splice(t,4,1,3,5,0),r(s)},nr=t=>{const e={};for(const[a,o]of Object.entries(t.outputHandles)){const i=Ot(o.dataType);if(i===void 0)return null;e[a]={dataType:o.dataType,resultOffset:i}}const r={type:t.type,inputHandles:t.inputHandles,outputHandles:e,...t.name&&{name:t.name}};if(!("setpointDataType"in t))return r;const s=qt(t.setpointDataType);return s===void 0?null:(t.type==="fourierInt"&&er(s),{...r,setpointDataType:t.setpointDataType,setpointOffset:s})},sr=(t,e)=>{const r=jn[t];if(!r)return P(`Неизвестный тип узла: ${t}`,{variant:"error"}),null;const s=nr(r);return s?{id:Tt(),type:"node",position:e,data:{...s}}:(P("Не удалось выделить память",{variant:"error"}),null)},rr=()=>{const t=zt(n=>n.addNode,mt),{screenToFlowPosition:e}=M();return{onDragOver:k.useCallback(n=>{n.preventDefault(),n.dataTransfer.dropEffect="move"},[]),onDrop:n=>{n.preventDefault();const a=n.dataTransfer.getData("application/reactflow"),o=e({x:n.clientX,y:n.clientY});console.log(a);const i=sr(a,o);i&&t(i)}}},ar=()=>{const{nodes:t,edges:e,onNodesChange:r,onEdgesChange:s,addEdge:n}=zt(On,mt),{onDragOver:a,onDrop:o}=rr(),{getNodes:i,getEdges:l}=M(),{enqueueSnackbar:p}=us();return{nodes:t,edges:e,onNodesChange:r,onEdgesChange:s,addEdge:n,onDragOver:a,onDrop:o,isValidConnection:b=>{var _,w,O,H;const I=i(),x=l(),d=b.source??"",g=b.target??"",m=b.sourceHandle,u=b.targetHandle,h=I.find(S=>S.id===d),y=I.find(S=>S.id===g);if(!h||!y||!m||!u)return!1;const v=((_=h.data.outputHandles[m==null?void 0:m.split(" ")[1]])==null?void 0:_.dataType)||((w=h.data.inputHandles[m==null?void 0:m.split(" ")[1]])==null?void 0:w.dataType),T=((O=y.data.inputHandles[u==null?void 0:u.split(" ")[1]])==null?void 0:O.dataType)||((H=y.data.outputHandles[u==null?void 0:u.split(" ")[1]])==null?void 0:H.dataType);if(v!==T)return!1;const C=(S,j=new Set)=>{if(j.has(S.id))return!1;j.add(S.id);for(const B of tn(S,I,x))if(B.id===d||C(B,j))return!0;return!1};return d===g?!1:!C(y)},onConnectEnd:(b,I)=>{var O,H,S,j,B,V,$,R;const{fromNode:x,fromHandle:d,toNode:g,toHandle:m,isValid:u}=I,h=F=>F==null?void 0:F.data;if(!x||!g||!(d!=null&&d.id)||!(m!=null&&m.id))return;const y=d.id.split(" ")[1],v=m.id.split(" ")[1],T=h(x),C=h(g),_=((H=(O=T.outputHandles)==null?void 0:O[y])==null?void 0:H.dataType)??((j=(S=T.inputHandles)==null?void 0:S[y])==null?void 0:j.dataType),w=((V=(B=C.inputHandles)==null?void 0:B[v])==null?void 0:V.dataType)??((R=($=C.outputHandles)==null?void 0:$[v])==null?void 0:R.dataType);_!==w&&u===!1&&p("Нерроектное соединение",{variant:"error"})}}},or=()=>{const{nodes:t,edges:e,onNodesChange:r,onEdgesChange:s,onDragOver:n,onDrop:a,isValidConnection:o,onConnectEnd:i,addEdge:l}=ar();return console.log(t),c.jsx("div",{className:Sn["graph-editor"],children:c.jsxs(nn,{deleteKeyCode:null,proOptions:Vs,nodeTypes:Fs,edgeTypes:Ws,nodes:t,edges:e,onNodesChange:r,onEdgesChange:s,onConnect:l,onDragOver:n,onDrop:a,connectionLineComponent:qs,isValidConnection:o,onConnectEnd:i,fitView:!0,children:[c.jsx(tr,{nodes:t}),c.jsx(sn,{}),c.jsx(rn,{})]})})},ir=()=>c.jsx(en,{children:c.jsx(ls,{maxSnack:3,children:c.jsx(or,{})})}),vr=()=>c.jsx(ir,{});export{vr as default};
